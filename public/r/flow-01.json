{
  "name": "flow-01",
  "type": "registry:block",
  "description": "A flow chart builder.",
  "dependencies": [
    "@xyflow/react",
    "zustand"
  ],
  "registryDependencies": [
    "button",
    "card",
    "dialog",
    "input",
    "textarea"
  ],
  "files": [
    {
      "path": "blocks/flow-01/page.tsx",
      "content": "\"use client\";\n\nimport {\n\tControls,\n\ttype EdgeTypes,\n\tMiniMap,\n\ttype NodeTypes,\n\tReactFlowProvider,\n} from \"@xyflow/react\";\nimport { Background, Panel, ReactFlow, useReactFlow } from \"@xyflow/react\";\nimport type React from \"react\";\nimport { shallow } from \"zustand/shallow\";\nimport \"@xyflow/react/dist/style.css\";\n/* import { DevTools } from \"@/components/flow/devtools\"; */\nimport { Button } from \"@/components/ui/button\";\nimport { NodesPanel } from \"@/components/nodes-panel\";\nimport { PromptCrafterNodeController } from \"@/components/prompt-crafter-node-controller\";\nimport { useWorkflow } from \"@/hooks/flow/use-workflow\";\nimport type { FlowNode } from \"@/lib/flow/workflow\";\nimport { Connection } from \"@/components/ui/flow/connection\";\nimport { Copy } from \"lucide-react\";\nimport { ErrorIndicator } from \"@/components/error-indicator\";\nimport { GenerateTextNodeController } from \"@/components/generate-text-node-controller\";\nimport { TextInputNodeController } from \"@/components/text-input-node-controller\";\nimport { VisualizeTextNodeController } from \"@/components/visualize-text-node-controller\";\n\nconst nodeTypes: NodeTypes = {\n\t\"generate-text\": GenerateTextNodeController,\n\t\"visualize-text\": VisualizeTextNodeController,\n\t\"text-input\": TextInputNodeController,\n\t\"prompt-crafter\": PromptCrafterNodeController,\n};\n\nconst edgeTypes: EdgeTypes = {\n\tconnection: Connection,\n};\n\nfunction Flow() {\n\tconst store = useWorkflow(\n\t\t(store) => ({\n\t\t\tnodes: store.nodes,\n\t\t\tedges: store.edges,\n\t\t\tonNodesChange: store.onNodesChange,\n\t\t\tonEdgesChange: store.onEdgesChange,\n\t\t\tonConnect: store.onConnect,\n\t\t\tstartExecution: store.startExecution,\n\t\t\tcreateNode: store.createNode,\n\t\t\tworkflowExecutionState: store.workflowExecutionState,\n\t\t}),\n\t\tshallow,\n\t);\n\n\tconst { screenToFlowPosition } = useReactFlow();\n\n\tconst onDragOver = (event: React.DragEvent) => {\n\t\tevent.preventDefault();\n\t\tevent.dataTransfer.dropEffect = \"move\";\n\t};\n\n\tconst onDrop = (event: React.DragEvent) => {\n\t\tevent.preventDefault();\n\n\t\tconst type = event.dataTransfer.getData(\n\t\t\t\"application/reactflow\",\n\t\t) as FlowNode[\"type\"];\n\n\t\t// Check if the dropped element is valid\n\t\tif (!type) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Get the position of the drop\n\t\tconst position = screenToFlowPosition({\n\t\t\tx: event.clientX,\n\t\t\ty: event.clientY,\n\t\t});\n\n\t\tstore.createNode(type, position);\n\t};\n\n\tconst handleExport = () => {\n\t\tconst exportData = {\n\t\t\tnodes: store.nodes.map((node) => ({\n\t\t\t\ttype: node.type,\n\t\t\t\tid: node.id,\n\t\t\t\tdata: {\n\t\t\t\t\t...node.data,\n\t\t\t\t\texecutionState: undefined,\n\t\t\t\t},\n\t\t\t\tposition: node.position,\n\t\t\t\twidth: node.width,\n\t\t\t\theight: node.height,\n\t\t\t})),\n\t\t\tedges: store.edges.map((edge) => ({\n\t\t\t\t...edge,\n\t\t\t\tdata: {\n\t\t\t\t\t...edge.data,\n\t\t\t\t\texecutionState: undefined,\n\t\t\t\t},\n\t\t\t})),\n\t\t};\n\t\tnavigator.clipboard.writeText(JSON.stringify(exportData, null, 2));\n\t};\n\n\treturn (\n\t\t<ReactFlow\n\t\t\tnodes={store.nodes}\n\t\t\tedges={store.edges}\n\t\t\tonNodesChange={store.onNodesChange}\n\t\t\tonEdgesChange={store.onEdgesChange}\n\t\t\tonConnect={store.onConnect}\n\t\t\tnodeTypes={nodeTypes}\n\t\t\tedgeTypes={edgeTypes}\n\t\t\tonDragOver={onDragOver}\n\t\t\tonDrop={onDrop}\n\t\t\tfitView\n\t\t>\n\t\t\t<Background />\n\t\t\t{/* <DevTools /> */}\n\t\t\t<Controls />\n\t\t\t<MiniMap />\n\t\t\t<NodesPanel />\n\t\t\t<Panel position=\"top-right\" className=\"flex gap-2 items-center\">\n\t\t\t\t<ErrorIndicator errors={store.workflowExecutionState.errors} />\n\t\t\t\t<Button\n\t\t\t\t\tonClick={handleExport}\n\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\tclassName=\"flex gap-2 items-center\"\n\t\t\t\t>\n\t\t\t\t\t<Copy className=\"h-4 w-4\" />\n\t\t\t\t\tExport Flow\n\t\t\t\t</Button>\n\t\t\t\t<Button\n\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\tstore.startExecution();\n\t\t\t\t\t}}\n\t\t\t\t\tdisabled={\n\t\t\t\t\t\tstore.workflowExecutionState.errors.length > 0 ||\n\t\t\t\t\t\tstore.workflowExecutionState.isRunning\n\t\t\t\t\t}\n\t\t\t\t>\n\t\t\t\t\t{store.workflowExecutionState.isRunning ? \"Running...\" : \"Run Flow\"}\n\t\t\t\t</Button>\n\t\t\t</Panel>\n\t\t</ReactFlow>\n\t);\n}\n\nexport default function Flow01Page() {\n\treturn (\n\t\t<div className=\"w-screen h-screen\">\n\t\t\t<ReactFlowProvider>\n\t\t\t\t<Flow />\n\t\t\t</ReactFlowProvider>\n\t\t</div>\n\t);\n}\n",
      "type": "registry:page",
      "target": "app/flow/page.tsx"
    }
  ]
}